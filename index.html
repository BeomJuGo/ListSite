<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê¹€ê³ ë‚œ ì•„ì´í…œ ëª©ë¡</title>

<style>
* { box-sizing: border-box; }

body {
  font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem;
  background: #f8fafc;
  color: #1e293b;
}

h1 { font-size: 1.8rem; margin-bottom: 1.5rem; }

.search-box {
  width: 100%;
  padding: 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  margin-bottom: 1.5rem;
}

.category-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

.category-buttons button {
  padding: 0.5rem 1rem;
  border: 1px solid #e2e8f0;
  background: white;
  border-radius: 6px;
  cursor: pointer;
}

.category-buttons button.active {
  background: #3b82f6;
  color: white;
  border-color: #3b82f6;
}

.item-list { list-style: none; padding: 0; margin: 0; }

.item-list li {
  padding: 1rem 1.25rem;
  background: white;
  border-radius: 8px;
  margin-bottom: 0.75rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
  transition: 0.2s;
}

.item-list li:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.08); }

.item-row { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }

.item-name { font-weight: 600; }

.item-info { display: flex; gap: 0.5rem; flex-wrap: wrap; }

.badge {
  padding: 0.3rem 0.7rem;
  font-size: 0.75rem;
  border-radius: 999px;
  font-weight: 600;
}

/* ë“±ê¸‰ ìƒ‰ìƒ */
.grade-ê³¨ë“œ { background: #facc15; color: #78350f; }
.grade-í¼í”Œ { background: #a855f7; color: white; }
.grade-ë¸”ë£¨ { background: #3b82f6; color: white; }
.grade-ë ˆë“œ { background: #ef4444; color: white; }
.grade-ê·¸ë¦° { background: #22c55e; color: white; }

/* ê°€ê²©, ìˆ˜ëŸ‰, ì„±ë³„ */
.price { background: #dcfce7; color: #166534; }
.qty { background: #e2e8f0; color: #334155; }
.gender { background: #f0fdfa; color: #0f766e; }

.no-results { text-align: center; padding: 3rem; color: #64748b; background: white; border-radius: 8px; }

</style>
</head>

<body>

<h1>ê¹€ê³ ë‚œ ì•„ì´í…œ ëª©ë¡</h1>

<input type="text" class="search-box" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ë„ì–´ì“°ê¸° ë¬´ì‹œ)">
<div class="category-buttons" id="categoryButtons"></div>

<ul class="item-list" id="itemList"></ul>
<div class="no-results" id="noResults" style="display:none;">
ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbytKwgl8ya7_Vg6-vObEJUjeFii4yuvsqNn0BBWNBt7YORXEN7mv2FSc4KAoGscL-RVwA/exec"; // ğŸ”¥ ì—¬ê¸°ì— Apps Script URL ë¶™ì—¬ë„£ê¸°

let ITEMS = [];

const state = { filteredItems: [], category: "ì „ì²´", searchQuery: "" };

function removeSpaces(str) { return str.replace(/\s/g, ""); }

async function loadItems() {
  try {
    const response = await fetch(WEB_APP_URL + "?t=" + Date.now());
    const data = await response.json();

    ITEMS = data.map(item => ({
      name: item.name,
      category: item.category,
      grade: item.grade,
      price: Number(item.price),
      quantity: Number(item.quantity),
      gender: item.gender
    }));

    state.filteredItems = ITEMS.filter(i => i.quantity > 0);

    renderCategoryButtons();
    renderList(state.filteredItems);

  } catch (err) {
    console.error("ì—ëŸ¬ ë°œìƒ:", err);
    alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
  }
}

function filterItems() {
  let result = ITEMS.filter(i => i.quantity > 0);

  if (state.category !== "ì „ì²´") result = result.filter(i => i.category === state.category);
  if (state.searchQuery) {
    const q = removeSpaces(state.searchQuery.toLowerCase());
    result = result.filter(i => removeSpaces(i.name.toLowerCase()).includes(q));
  }

  state.filteredItems = result;
  renderList(result);
}

function renderCategoryButtons() {
  const container = document.getElementById("categoryButtons");
  const categories = ["ì „ì²´", ...new Set(ITEMS.filter(i=>i.quantity>0).map(i=>i.category))];

  container.innerHTML = categories.map(cat =>
    `<button class="${cat===state.category?"active":""}" data-cat="${cat}">${cat}</button>`
  ).join("");

  container.querySelectorAll("button").forEach(btn => {
    btn.addEventListener("click", () => {
      state.category = btn.dataset.cat;
      renderCategoryButtons();
      filterItems();
    });
  });
}

function renderList(items) {
  const listEl = document.getElementById("itemList");
  const noResultsEl = document.getElementById("noResults");

  if(items.length===0){ listEl.innerHTML=""; noResultsEl.style.display="block"; return; }

  noResultsEl.style.display="none";

  // ğŸ”¥ genderë¥¼ grade ì™¼ìª½ìœ¼ë¡œ ì´ë™
  listEl.innerHTML = items.map(item => `
    <li>
      <div class="item-row">
        <div class="item-name">${item.name}</div>
        <div class="item-info">
          <span clas
